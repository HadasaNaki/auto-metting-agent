name: ğŸš€ SmartAgent Perfect Build

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:
    inputs:
      build_type:
        description: 'Build Type'
        required: true
        default: 'debug'
        type: choice
        options:
        - debug
        - release

jobs:
  build-perfect-apk:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout SmartAgent Code
      uses: actions/checkout@v4
      
    - name: â˜• Setup Perfect Java 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        
    - name: ğŸ¤– Setup Android SDK
      uses: android-actions/setup-android@v3
      
    - name: ğŸ† Cache Gradle for Speed
      uses: actions/cache@v4
      with:
        path: |
          ~/.gradle/caches
          ~/.gradle/wrapper
        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
        restore-keys: |
          ${{ runner.os }}-gradle-
          
    - name: ğŸ”§ Make Gradlew Executable
      run: chmod +x android_app/gradlew
      
    - name: ğŸ“± Build Perfect APK
      run: |
        cd android_app
        echo "ğŸš€ Building SmartAgent with revolutionary AI features..."
        ./gradlew clean
        ./gradlew assembleDebug --stacktrace --info
        
    - name: âœ… Verify APK Built Successfully
      run: |
        if [ -f "android_app/app/build/outputs/apk/debug/app-debug.apk" ]; then
          echo "ğŸ‰ APK built successfully!"
          ls -la android_app/app/build/outputs/apk/debug/
        else
          echo "âŒ APK build failed!"
          exit 1
        fi
        
    - name: ğŸ“¦ Upload SmartAgent APK
      uses: actions/upload-artifact@v4
      with:
        name: SmartAgent-Revolutionary-APK
        path: android_app/app/build/outputs/apk/debug/app-debug.apk
        retention-days: 30
        
    - name: ğŸ¯ Create Perfect Release
      if: github.ref == 'refs/heads/main'
      uses: softprops/action-gh-release@v1
      with:
        tag_name: v1.0.${{ github.run_number }}
        name: ğŸš€ SmartAgent v1.0.${{ github.run_number }} - Revolutionary AI App
        body: |
          # ğŸ‰ SmartAgent - ×”××¤×œ×™×§×¦×™×” ×”××”×¤×›× ×™×ª ×œ×˜×›× ××™×!
          
          ## ï¿½ ×ª×›×•× ×•×ª ××”×¤×›× ×™×•×ª:
          - ğŸ¤ **×”×§×œ×˜×ª ×©×™×—×•×ª** ×¢× ×ª××œ×•×œ ×¢×‘×¨×™×ª ××“×•×™×§ ×‘-AI
          - ğŸ¤– **×—×™×œ×•×¥ ×¤×¨×˜×™ ×œ×§×•×—** ××•×˜×•××˜×™ ××”×©×™×—×”
          - ğŸ¯ **×¢×•×–×¨ ×§×•×œ×™ ×‘×¢×‘×¨×™×ª** - × ×™×•×•×˜ ×‘×§×•×œ (60% ×—×™×¡×›×•×Ÿ ×‘×–××Ÿ)
          - ğŸ” **××‘×—×•×Ÿ AR** - ×–×™×”×•×™ ×¦×™×•×“ ×¢× ××¦×œ××” (85% ×©×™×¤×•×¨ ×‘××‘×—×•×Ÿ)
          - ğŸ”® **AI ×œ×—×™×–×•×™ ×ª×§×œ×•×ª** - ×ª×—×–×•×§×” ××•× ×¢×ª (70% ×”×¤×—×ª×ª ×ª×§×œ×•×ª)
          - ğŸ’¾ **××¡×“ × ×ª×•× ×™× ××§×•××™** - ×¢×•×‘×“ ×œ×œ× ××™× ×˜×¨× ×˜
          
          ## ğŸ“± ×”×ª×§× ×” ×§×œ×”:
          1. **×”×•×¨×“** ××ª `app-debug.apk` ×œ××˜×” â¬‡ï¸
          2. **×”×¢×‘×¨ ×œ×˜×œ×¤×•×Ÿ** (WhatsApp/Email/USB)
          3. **×”×’×“×¨×•×ª** â†’ **××‘×˜×—×”** â†’ **××¤×©×¨ "××§×•×¨×•×ª ×œ× ×™×“×•×¢×™×"**
          4. **×¤×ª×— ××ª ×”×§×•×‘×¥** ×•×”×ª×§×Ÿ ğŸ¯
          
          ## ğŸ† ×œ××” ×–×” ××”×¤×›× ×™:
          - **×”×¨××©×•×Ÿ ×‘×™×©×¨××œ** ×¢× AI ××ª×§×“× ×œ×˜×›× ××™×
          - **×ª×›×•× ×•×ª ×©×œ× ×§×™×™××•×ª** ×‘××£ ××¤×œ×™×§×¦×™×” ××—×¨×ª
          - **×¤×•×ª×— ×‘××™×•×—×“** ×œ×˜×›× ××™ ×™×©×¨××œ×™
          - **×˜×›× ×•×œ×•×’×™×™×ª ×¢×ª×™×“** ×–××™× ×” ×”×™×•×!
          
          ## ğŸš€ ×‘× ×•×™ ××•×˜×•××˜×™×ª ×¢×:
          âœ… GitHub Actions  
          âœ… Android SDK 33  
          âœ… Java 17  
          âœ… ×›×œ ×”×ª×œ×•×™×•×ª ××¢×•×“×›× ×•×ª  
          
          **×ª×”× ×” ××”××¤×œ×™×§×¦×™×” ×”××”×¤×›× ×™×ª!** ğŸ‡®ğŸ‡±
        files: android_app/app/build/outputs/apk/debug/app-debug.apk
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
