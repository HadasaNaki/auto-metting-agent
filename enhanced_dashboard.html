
<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartAgent - דשבורד מתקדם</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 20px; margin-bottom: 30px; }
        .header h1 { color: white; font-size: 2.5em; text-align: center; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { color: rgba(255,255,255,0.9); text-align: center; margin-top: 10px; font-size: 1.2em; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; color: white; transition: transform 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-number { font-size: 3em; font-weight: bold; margin-bottom: 10px; }
        .stat-label { font-size: 1.1em; opacity: 0.9; }
        .actions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .action-card { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; }
        .action-card h3 { color: white; margin-bottom: 15px; font-size: 1.4em; }
        .btn { background: linear-gradient(45deg, #FF6B6B, #4ECDC4); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-size: 1em; transition: all 0.3s ease; margin: 5px; display: inline-block; text-decoration: none; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .recent-activity { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; }
        .recent-activity h3 { color: white; margin-bottom: 20px; font-size: 1.4em; }
        .activity-item { background: rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; margin-bottom: 10px; color: white; }
        .activity-time { font-size: 0.9em; opacity: 0.7; }
        .quick-stats { display: flex; justify-content: space-around; margin: 20px 0; }
        .quick-stat { text-align: center; color: white; }
        .emoji { font-size: 2em; display: block; margin-bottom: 10px; }
        .status-indicator { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-left: 10px; }
        .status-online { background-color: #4CAF50; }
        .status-busy { background-color: #FF9800; }
        .status-offline { background-color: #F44336; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚀 SmartAgent - דשבורד מתקדם</h1>
            <p>מערכת ניהול שיחות וטכנאים חכמה</p>
            <div class="quick-stats">
                <div class="quick-stat">
                    <span class="emoji">📞</span>
                    <div>שיחות היום</div>
                    <div id="today-calls">12</div>
                </div>
                <div class="quick-stat">
                    <span class="emoji">⚡</span>
                    <div>תורים פעילים</div>
                    <div id="active-appointments">8</div>
                </div>
                <div class="quick-stat">
                    <span class="emoji">👥</span>
                    <div>טכנאים זמינים</div>
                    <div id="available-technicians">3</div>
                </div>
                <div class="quick-stat">
                    <span class="emoji">⭐</span>
                    <div>שביעות רצון</div>
                    <div id="satisfaction">4.8/5</div>
                </div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="total-calls">47</div>
                <div class="stat-label">סה״כ שיחות</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="processed-calls">42</div>
                <div class="stat-label">שיחות מעובדות</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="scheduled-appointments">38</div>
                <div class="stat-label">תורים מתוזמנים</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="satisfied-customers">92%</div>
                <div class="stat-label">לקוחות מרוצים</div>
            </div>
        </div>

        <div class="actions-grid">
            <div class="action-card">
                <h3>🎯 פעולות מהירות</h3>
                <button class="btn" onclick="simulateCall()">דמה שיחה חדשה</button>
                <button class="btn" onclick="processWorkflow()">הרץ זרימה מלאה</button>
                <button class="btn" onclick="refreshData()">רענן נתונים</button>
                <button class="btn" onclick="viewReports()">דוחות מתקדמים</button>
            </div>
            
            <div class="action-card">
                <h3>📊 ניהול טכנאים</h3>
                <button class="btn" onclick="viewTechnicians()">רשימת טכנאים</button>
                <button class="btn" onclick="assignJobs()">הקצאת עבודות</button>
                <button class="btn" onclick="trackLocation()">מעקב מיקום</button>
                <button class="btn" onclick="performanceReview()">סקירת ביצועים</button>
            </div>
            
            <div class="action-card">
                <h3>💼 ניהול לקוחות</h3>
                <button class="btn" onclick="viewCustomers()">רשימת לקוחות</button>
                <button class="btn" onclick="addCustomer()">הוסף לקוח חדש</button>
                <button class="btn" onclick="sendMessage()">שלח הודעה</button>
                <button class="btn" onclick="feedbackAnalysis()">ניתוח משוב</button>
            </div>
        </div>

        <div class="recent-activity">
            <h3>📈 פעילות אחרונה</h3>
            <div id="activity-list">
                <div class="activity-item">
                    <strong>שיחה חדשה התקבלה</strong> - משה כהן, תיקון מקרר
                    <div class="activity-time">לפני 5 דקות</div>
                    <span class="status-indicator status-online"></span>
                </div>
                <div class="activity-item">
                    <strong>תור נקבע בהצלחה</strong> - רות לוי, מזגן לא עובד
                    <div class="activity-time">לפני 12 דקות</div>
                    <span class="status-indicator status-busy"></span>
                </div>
                <div class="activity-item">
                    <strong>טכנאי יוסי סיים עבודה</strong> - דירוג 5 כוכבים
                    <div class="activity-time">לפני 20 דקות</div>
                    <span class="status-indicator status-online"></span>
                </div>
                <div class="activity-item">
                    <strong>הודעת SMS נשלחה</strong> - אישור תור לדוד אברהם
                    <div class="activity-time">לפני 25 דקות</div>
                    <span class="status-indicator status-online"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        function simulateCall() {
            fetch('/api/simulate/call', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    alert('✅ שיחה חדשה נוצרה בהצלחה!\nמזהה שיחה: ' + (data.call_id || 'חדש'));
                    refreshData();
                })
                .catch(err => alert('❌ שגיאה: ' + err.message));
        }

        function processWorkflow() {
            fetch('/api/simulate/full-flow', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    alert('✅ זרימה מלאה הושלמה!\nלקוח: ' + (data.customer || 'חדש') + '\nתור: ' + (data.appointment || 'נקבע'));
                    refreshData();
                })
                .catch(err => alert('❌ שגיאה: ' + err.message));
        }

        function refreshData() {
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('total-calls').textContent = data.total_calls || '47';
                    document.getElementById('processed-calls').textContent = data.processed_calls || '42';
                    document.getElementById('scheduled-appointments').textContent = data.appointments || '38';
                    
                    // עדכון פעילות אחרונה
                    updateRecentActivity();
                })
                .catch(err => console.error('Error refreshing data:', err));
        }

        function updateRecentActivity() {
            const activities = [
                'שיחה חדשה מעובדת - ' + ['אמיר שמש', 'דנה רוזן', 'יוסי כהן'][Math.floor(Math.random() * 3)],
                'תור נקבע - ' + ['מכונת כביסה', 'מקרר', 'מזגן'][Math.floor(Math.random() * 3)],
                'טכנאי סיים עבודה - דירוג ' + (4 + Math.random()).toFixed(1) + ' כוכבים',
                'הודעה נשלחה ללקוח - אישור הגעה'
            ];
            
            const activityList = document.getElementById('activity-list');
            const newActivity = document.createElement('div');
            newActivity.className = 'activity-item';
            newActivity.innerHTML = `
                <strong>${activities[Math.floor(Math.random() * activities.length)]}</strong>
                <div class="activity-time">עכשיו</div>
                <span class="status-indicator status-online"></span>
            `;
            activityList.insertBefore(newActivity, activityList.firstChild);
            
            if (activityList.children.length > 6) {
                activityList.removeChild(activityList.lastChild);
            }
        }

        function viewTechnicians() { alert('📋 פתיחת ממשק ניהול טכנאים...'); }
        function assignJobs() { alert('⚡ פתיחת מערכת הקצאת עבודות...'); }
        function trackLocation() { alert('📍 פתיחת מעקב מיקום בזמן אמת...'); }
        function performanceReview() { alert('📊 פתיחת דוח ביצועי טכנאים...'); }
        function viewCustomers() { alert('👥 פתיחת רשימת לקוחות...'); }
        function addCustomer() { alert('➕ פתיחת טופס לקוח חדש...'); }
        function sendMessage() { alert('💬 פתיחת מערכת הודעות...'); }
        function feedbackAnalysis() { alert('⭐ פתיחת ניתוח משוב לקוחות...'); }
        function viewReports() { alert('📈 פתיחת דוחות מתקדמים...'); }

        // רענון אוטומטי כל 30 שניות
        setInterval(refreshData, 30000);
        
        // רענון נתונים בטעינה
        window.onload = refreshData;
    </script>
</body>
</html>
        